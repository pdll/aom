"use strict";(self.webpackChunkwebsite=self.webpackChunkwebsite||[]).push([[9081],{3905:function(e,t,n){n.d(t,{Zo:function(){return p},kt:function(){return m}});var a=n(7294);function o(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function i(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function r(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?i(Object(n),!0).forEach((function(t){o(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):i(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function l(e,t){if(null==e)return{};var n,a,o=function(e,t){if(null==e)return{};var n,a,o={},i=Object.keys(e);for(a=0;a<i.length;a++)n=i[a],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}var s=a.createContext({}),d=function(e){var t=a.useContext(s),n=t;return e&&(n="function"==typeof e?e(t):r(r({},t),e)),n},p=function(e){var t=d(e.components);return a.createElement(s.Provider,{value:t},e.children)},c={inlineCode:"code",wrapper:function(e){var t=e.children;return a.createElement(a.Fragment,{},t)}},u=a.forwardRef((function(e,t){var n=e.components,o=e.mdxType,i=e.originalType,s=e.parentName,p=l(e,["components","mdxType","originalType","parentName"]),u=d(n),m=o,h=u["".concat(s,".").concat(m)]||u[m]||c[m]||i;return n?a.createElement(h,r(r({ref:t},p),{},{components:n})):a.createElement(h,r({ref:t},p))}));function m(e,t){var n=arguments,o=t&&t.mdxType;if("string"==typeof e||o){var i=n.length,r=new Array(i);r[0]=u;var l={};for(var s in t)hasOwnProperty.call(t,s)&&(l[s]=t[s]);l.originalType=e,l.mdxType="string"==typeof e?e:o,r[1]=l;for(var d=2;d<i;d++)r[d]=n[d];return a.createElement.apply(null,r)}return a.createElement.apply(null,n)}u.displayName="MDXCreateElement"},4972:function(e,t,n){n.r(t),n.d(t,{frontMatter:function(){return l},contentTitle:function(){return s},metadata:function(){return d},toc:function(){return p},default:function(){return u}});var a=n(7462),o=n(3366),i=(n(7294),n(3905)),r=["components"],l={title:"Endpoints decorators",sidebar_position:2},s=void 0,d={unversionedId:"api/koa/endpoints",id:"api/koa/endpoints",isDocsHomePage:!1,title:"Endpoints decorators",description:"The routes endpoints",source:"@site/docs/api/koa/endpoints.md",sourceDirName:"api/koa",slug:"/api/koa/endpoints",permalink:"/docs/api/koa/endpoints",tags:[],version:"current",sidebarPosition:2,frontMatter:{title:"Endpoints decorators",sidebar_position:2},sidebar:"api",previous:{title:"Working with Koa",permalink:"/docs/api/koa/index"},next:{title:"Bridges and Middlewares",permalink:"/docs/api/koa/middlewares"}},p=[{value:"The routes endpoints",id:"the-routes-endpoints",children:[]},{value:"Common endpoints",id:"common-endpoints",children:[]}],c={toc:p};function u(e){var t=e.components,n=(0,o.Z)(e,r);return(0,i.kt)("wrapper",(0,a.Z)({},c,n,{components:t,mdxType:"MDXLayout"}),(0,i.kt)("h2",{id:"the-routes-endpoints"},"The routes endpoints"),(0,i.kt)("p",null,"All endpoints are created using decorators from the following list:"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"@Endpoint(path, method = 'get'|'post'|'put'|'patch'|'delete'|'options'|'all')")," - creates\n",(0,i.kt)("inlineCode",{parentName:"li"},"endpoint"),", pointing to the address ",(0,i.kt)("inlineCode",{parentName:"li"},"path")," on the ",(0,i.kt)("inlineCode",{parentName:"li"},"method")," method. To create an endpoint via\nthis decorator, you must specify at least the method to be used. Calling this decorator\nwithout arguments creates a common endpoint (more details below). Default: ",(0,i.kt)("inlineCode",{parentName:"li"},"path='/'"),"."),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"@Get(path)")," - shortcut for ",(0,i.kt)("inlineCode",{parentName:"li"},"@Endpoint(path, 'get')")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"@Post(path)")," - shortcut for ",(0,i.kt)("inlineCode",{parentName:"li"},"@Endpoint(path, 'post')")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"@Put(path)")," - shortcut for ",(0,i.kt)("inlineCode",{parentName:"li"},"@Endpoint(path, 'put')")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"@Patch(path)")," - shortcut for ",(0,i.kt)("inlineCode",{parentName:"li"},"@Endpoint(path, 'patch')")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"@Delete(path)")," - shortcut for ",(0,i.kt)("inlineCode",{parentName:"li"},"@Endpoint(path, 'delete')")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"@Options(path)")," - shortcut for ",(0,i.kt)("inlineCode",{parentName:"li"},"@Endpoint(path, 'options')")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"@All(path)")," - shortcut for ",(0,i.kt)("inlineCode",{parentName:"li"},"@Endpoint(path, 'all')"))),(0,i.kt)("p",null,"All shortcuts decorators are applied over static class methods without a second argument.\nThe use of the second argument applies only to common endpoints (described below), and\nis used as class decorators."),(0,i.kt)("p",null,"The ",(0,i.kt)("inlineCode",{parentName:"p"},"path")," value can have several levels of nesting, and even contain a typical ",(0,i.kt)("inlineCode",{parentName:"p"},"koa-router")," parameter.\nAs the value of the link, a fragment of the address is used, which characterizes this method exclusively\nwithin the given route node. The full name of the address will be built based on all links,\nwhich preceded the given ",(0,i.kt)("inlineCode",{parentName:"p"},"endpoint"),"."),(0,i.kt)("p",null,"The specified decorators are applied as follows:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-ts"},'// ... index.ts\nimport { Get, Post, Body } from "aom";\n\nclass Index {\n  @Get()\n  static Hello() {\n    return `Hello, I\'m aom`;\n  }\n\n  @Post("/save")\n  static Save(@Body() body: any) {\n    return body;\n  }\n\n  @Get("/choose/:variant")\n  static Variant(@Params("variant") variant) {\n    return { variant };\n  }\n}\n')),(0,i.kt)("p",null,"This will create a route node with methods: ",(0,i.kt)("inlineCode",{parentName:"p"},"GET /"),", ",(0,i.kt)("inlineCode",{parentName:"p"},"POST /save")," and ",(0,i.kt)("inlineCode",{parentName:"p"},"GET /choose/:variant"),",\nwhich, after connecting to the route map, will provide access to them using the declared prefixes."),(0,i.kt)("h2",{id:"common-endpoints"},"Common endpoints"),(0,i.kt)("p",null,(0,i.kt)("inlineCode",{parentName:"p"},"aom")," allows you to create common endpoints, allowing you to reuse the same code in different\nplaces at a different access address and, if necessary, in a different method."),(0,i.kt)("p",null,"To declare a class method as a common endpoint, use the ",(0,i.kt)("inlineCode",{parentName:"p"},"@Endpoint()")," decorator with no arguments.\nThen this method can be used as the second argument for the shortcut decorators applied to the\nclass in which you want to use these methods."),(0,i.kt)("p",null,"Example:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-ts"},'// let\'s create two common endpoints that use the value of the data model from the context state\nclass Data {\n  @Endpoint()\n  static List(@State() { model }, @Query() query) {\n    return model.find({ ...query });\n  }\n\n  @Endpoint()\n  static Add(@State() { model }, @Body() body) {\n    return model.create({ ...body });\n  }\n}\n\n// create a route node in which the `Users` data model will be declared upon initiation\n// and connect the previously declared destination points to it by the specified path and methods\n@Use(Users.Init)\n@Get("/", Data.List)\n@Post("/", Data.Add)\nclass Users {\n  model = models.Users;\n\n  @Middleware()\n  static Init(@State() state, @This() { model }: Users, @Next() next) {\n    Object.assign(state, { model });\n    return next();\n  }\n}\n\n// create a route node in which the `Customers` data model will be declared upon initiation\n// and connect the previously declared destination points to it by the specified path and methods\n@Use(Customers.Init)\n@Get("/", Data.List)\n@Post("/", Data.Add)\nclass Customers {\n  model = models.Customers;\n\n  @Middleware()\n  static Init(@State() state, @This() { model }: Users, @Next() next) {\n    Object.assign(state, { model });\n    return next();\n  }\n}\n')),(0,i.kt)("p",null,'Only methods that were invoked as "common" decorators can be used as the second argument for\nthe ',(0,i.kt)("inlineCode",{parentName:"p"},"Get"),"/",(0,i.kt)("inlineCode",{parentName:"p"},"Post"),"/",(0,i.kt)("inlineCode",{parentName:"p"},"Put"),"/",(0,i.kt)("inlineCode",{parentName:"p"},"Patch"),"/ ",(0,i.kt)("inlineCode",{parentName:"p"},"Options"),"/",(0,i.kt)("inlineCode",{parentName:"p"},"Delete"),"/",(0,i.kt)("inlineCode",{parentName:"p"},"All")," decorators. Otherwise, the build will\nthrow an error."),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},"Important!"),' The context of "common" endpoints is the class in which they are declared: that is,\nthe default ',(0,i.kt)("inlineCode",{parentName:"p"},"@This")," decorator will use its own class (in the example, ",(0,i.kt)("inlineCode",{parentName:"p"},"Data"),"), and the\nreturn value of the ",(0,i.kt)("inlineCode",{parentName:"p"},"@Route()")," with different calls will differ only in the values of ",(0,i.kt)("inlineCode",{parentName:"p"},"path")," and ",(0,i.kt)("inlineCode",{parentName:"p"},"method"),"."))}u.isMDXComponent=!0}}]);